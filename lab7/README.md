
# Sentiment & Drug Flask Web App

This repository contains a small Flask application that demonstrates:

* **Sentiment analysis** (binary classification – positive / negative) using a **Bernoulli Naive Bayes** model trained from `exercise1.ipynb`.
* **Drug recommendation** (multi‑class classification) using a **Gaussian Naive Bayes** model trained from `exercise2.ipynb`.

The web UI lets you:

1. Type an English sentence – receive *Positive* or *Negative*.
2. Enter simple patient attributes – receive a predicted drug (`drugA … DrugY`).

## Project Structure

```
sentiment_drug_app_fixed/
├─ flask_app.py           # Flask server
├─ templates/
│   └─ index.html         # Front‑end UI
├─ artefacts_ex1/         # Saved vectorizer & sentiment model (generated by exercise1.ipynb)
│   ├─ vectorizer.pkl
│   └─ model.pkl
├─ artefacts_ex2/         # Saved drug model (generated by exercise2.ipynb)
│   └─ model.pkl
└─ README.md              # (this file)
```

## Setup & Run

1. **Train & export artefacts**

   Open each notebook inside **this folder** and run all cells:

   * `exercise1.ipynb` – at the end it creates `artefacts_ex1/`.
   * `exercise2.ipynb` – at the end it creates `artefacts_ex2/`.

   > Two helper cells (`dump artefacts`) are already included; run them **after fitting** the models.

2. **Install dependencies**

   ```bash
   pip install flask scikit-learn joblib numpy pandas
   ```

3. **Launch server**

   ```bash
   python flask_app.py
   ```

   Flask starts on <http://127.0.0.1:5000>. Open that URL in a browser.

## Quick Demo

![Web UI demo](be7e49c3-f05a-4c4b-ba9e-41b540b72d8b.png)

*The screenshot shows a negative sentiment prediction. Drug prediction appears below once the form is filled.*

## Notes

* The models are intentionally lightweight, trained on the small example datasets shipped with the notebooks.
* `flask_app.py` automatically searches for artefacts in the current folder **or one level above**, so you can reorganise folders without code changes.
* To “override” sentiment labels for specific sentences, extend the `user_overrides.json` mechanism described in the docstring.

&copy; 2025 – Educational demo.
